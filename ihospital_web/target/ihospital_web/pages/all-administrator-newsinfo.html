<!DOCTYPE html>
<html>

<head>
  <!-- 页面meta -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Background Management</title>
  <meta name="description" content="AdminLTE2定制版">
  <meta name="keywords" content="AdminLTE2定制版">


  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.6 -->
  <!-- Font Awesome -->
  <!-- Ionicons -->
  <!-- iCheck -->
  <!-- Morris chart -->
  <!-- jvectormap -->
  <!-- Date Picker -->
  <!-- Daterange picker -->
  <!-- Bootstrap time Picker -->
  <!--<link rel="stylesheet" href="../../../plugins/timepicker/bootstrap-timepicker.min.css">-->
  <!-- bootstrap wysihtml5 - text editor -->
  <!--数据表格-->
  <!-- 表格树 -->
  <!-- select2 -->
  <!-- Bootstrap Color Picker -->
  <!-- bootstrap wysihtml5 - text editor -->
  <!--bootstrap-markdown-->
  <!-- Theme style -->
  <!-- AdminLTE Skins. Choose a skin from the css/skins
     folder instead of downloading all of them to reduce the load. -->
  <!-- Ion Slider -->
  <!-- ion slider Nice -->
  <!-- bootstrap slider -->
  <!-- bootstrap-datetimepicker -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->


  <!-- jQuery 2.2.3 -->
  <!-- jQuery UI 1.11.4 -->
  <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
  <!-- Bootstrap 3.3.6 -->
  <!-- Morris.js charts -->
  <!-- Sparkline -->
  <!-- jvectormap -->
  <!-- jQuery Knob Chart -->
  <!-- daterangepicker -->
  <!-- datepicker -->
  <!-- Bootstrap WYSIHTML5 -->
  <!-- Slimscroll -->
  <!-- FastClick -->
  <!-- iCheck -->
  <!-- AdminLTE App -->
  <!-- 表格树 -->
  <!-- select2 -->
  <!-- bootstrap color picker -->
  <!-- bootstrap time picker -->
  <!--<script src="../../../plugins/timepicker/bootstrap-timepicker.min.js"></script>-->
  <!-- Bootstrap WYSIHTML5 -->
  <!--bootstrap-markdown-->
  <!-- CK Editor -->
  <!-- InputMask -->
  <!-- DataTables -->
  <!-- ChartJS 1.0.1 -->
  <!-- FLOT CHARTS -->
  <!-- FLOT RESIZE PLUGIN - allows the chart to redraw when the window is resized -->
  <!-- FLOT PIE PLUGIN - also used to draw donut charts -->
  <!-- FLOT CATEGORIES PLUGIN - Used to draw bar charts -->
  <!-- jQuery Knob -->
  <!-- Sparkline -->
  <!-- Morris.js charts -->
  <!-- Ion Slider -->
  <!-- Bootstrap slider -->
  <!-- bootstrap-datetimepicker -->
  <!-- 页面meta /-->

  <link rel="stylesheet" href="../plugins/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="../plugins/ionicons/css/ionicons.min.css">
  <link rel="stylesheet" href="../plugins/iCheck/square/blue.css">
  <link rel="stylesheet" href="../plugins/morris/morris.css">
  <link rel="stylesheet" href="../plugins/jvectormap/jquery-jvectormap-1.2.2.css">
  <link rel="stylesheet" href="../plugins/datepicker/datepicker3.css">
  <link rel="stylesheet" href="../plugins/daterangepicker/daterangepicker.css">
  <link rel="stylesheet" href="../plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
  <link rel="stylesheet" href="../plugins/datatables/dataTables.bootstrap.css">
  <link rel="stylesheet" href="../plugins/treeTable/jquery.treetable.css">
  <link rel="stylesheet" href="../plugins/treeTable/jquery.treetable.theme.default.css">
  <link rel="stylesheet" href="../plugins/select2/select2.css">
  <link rel="stylesheet" href="../plugins/colorpicker/bootstrap-colorpicker.min.css">
  <link rel="stylesheet" href="../plugins/bootstrap-markdown/css/bootstrap-markdown.min.css">
  <link rel="stylesheet" href="../plugins/adminLTE/css/AdminLTE.css">
  <link rel="stylesheet" href="../plugins/adminLTE/css/skins/_all-skins.min.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../plugins/ionslider/ion.rangeSlider.css">
  <link rel="stylesheet" href="../plugins/ionslider/ion.rangeSlider.skinNice.css">
  <link rel="stylesheet" href="../plugins/bootstrap-slider/slider.css">
  <link rel="stylesheet" href="../plugins/bootstrap-datetimepicker/bootstrap-datetimepicker.css">

  <link rel="stylesheet" href="../plugins/angular-datepicker/css/ng-bs3-datepicker.css">


</head>

<body class="hold-transition skin-purple-light sidebar-mini" ng-app="ihospital" ng-controller="addnewsController"
      ng-init="findOne()">

<div class="wrapper">

  <!-- 页面头部 -->


  <header class="main-header">
    <!-- Logo -->
    <a href="#" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
      <span class="logo-mini"><b>OS</b></span>
      <!-- logo for regular state and mobile devices -->
      <span class="logo-lg"><b>Outpatient System</b></span>
    </a>


    <!-- Header Navbar: style can be found in header.less -->
    <nav class="navbar navbar-static-top">

      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>

      <div class="navbar-custom-menu">
        <ul class="nav navbar-nav">


          <!-- User Account: style can be found in dropdown.less -->
          <li class="dropdown user user-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <img src="../img/user2-160x160.jpg" class="user-image" alt="User Image">
              <span class="hidden-xs">{{loginName}}</span>
            </a>
            <ul class="dropdown-menu">
              <!-- User image -->
              <li class="user-header">
                <img src="../img/user2-160x160.jpg" class="img-circle" alt="User Image">

                <p>
                  Administrator
                  <small></small>
                </p>
              </li>
              <!-- Menu Body
      <li class="user-body">
          <div class="row">
              <div class="col-xs-4 text-center">
                  <a href="#">Followers</a>
              </div>
              <div class="col-xs-4 text-center">
                  <a href="#">Sales</a>
              </div>
              <div class="col-xs-4 text-center">
                  <a href="#">Friends</a>
              </div>
          </div>
      </li>-->
              <!-- Menu Footer-->
              <li class="user-footer">
                <div class="pull-left">
                  <a href="#" class="btn btn-default btn-flat">Setting</a>
                </div>
                <div class="pull-right">
                  <a href="../logout" class="btn btn-default btn-flat">Log out</a>
                </div>
              </li>
            </ul>
          </li>

        </ul>
      </div>
    </nav>
  </header>


  <!-- 页面头部 /-->

  <!-- 导航侧栏 -->
  <aside class="main-sidebar">
    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">
      <!-- Sidebar user panel -->
      <div class="user-panel">
        <div class="pull-left image">
          <img src="../img/user2-160x160.jpg" class="img-circle" alt="User Image">
        </div>
        <div class="pull-left info">
          <p>{{loginName}}</p>
          <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
        </div>
      </div>
      <!-- search form -->
      <!--<form action="#" method="get" class="sidebar-form">
  <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="搜索...">
      <span class="input-group-btn">
      <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i>
      </button>
    </span>
  </div>
</form>-->
      <!-- /.search form -->


      <!-- sidebar menu: : style can be found in sidebar.less -->
      <ul class="sidebar-menu">
        <li class="header">Menu</li>

        <li id="admin-index"><a onclick="window.location.href='all-administrator-departmenttable.html'"><i
            class="fa fa-hospital-o"></i>
          <span>Department</span></a></li>
        <li id="admin-index"><a onclick="window.location.href='all-administrator-doctortable.html'"><i
            class="fa fa-user-md"></i> <span>Doctor</span></a>
        </li>
        <li id="admin-index"><a onclick="window.location.href='all-administrator-patienttable.html'"><i
            class="fa fa-user"></i> <span>Patient</span></a>
        </li>
        <li id="admin-index"><a onclick="window.location.href='all-administrator-commenttable.html'"><i
            class="fa fa-list"></i> <span>Comment</span></a>
        </li>
        <li id="admin-index"><a onclick="window.location.href='all-administrator-drugtable.html'"><i
            class="fa fa-plus-square"></i> <span>Drug</span></a>
        </li>
        <li id="admin-index"><a onclick="window.location.href='all-administrator-medicalrecordtable.html'"><i
            class="fa fa-stethoscope"></i> <span>Medical Record</span></a></li>
        <li id="admin-index"><a onclick="window.location.href='all-administrator-newstable.html'"><i
            class="fa fa-newspaper-o"></i> <span>News</span></a>
        </li>


        <!-- 菜单 -->


        <!-- 菜单 /-->


      </ul>
    </section>
    <!-- /.sidebar -->
  </aside>
  <!-- 导航侧栏 /-->

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        News Info
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i>Home</a></li>
        <li><a href="#">Administrator</a></li>
        <li><a href="#">News Management</a></li>
        <li class="active">News Info</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content">

      <!-- .box-body -->
      <div class="box-body">

        <div class="nav-tabs-custom">

          <!--tab头-->
          <ul class="nav nav-tabs">


            <li class="active">
              <a href="#tab-setting" data-toggle="tab">Basic Information</a>
            </li>
            <li>
              <a href="#tab-picture" data-toggle="tab">Picture</a>
            </li>
          </ul>
          <div class="tab-content">


            <div class="tab-pane active" id="tab-setting">
              <form role="form">

                <div class="form-group">
                  <div class="row data-type">
                    <div class="col-md-1 title">Title</div>

                    <div class="col-md-5 data">
                      <input type="text" class="form-control" ng-model="entity.title"
                             placeholder="Title" required="required">
                    </div>
                    <div class="col-md-1 title">Time</div>
                    <div class="col-md-5 data text ">
                      <input type="text" class="form-control" ng-model="nowtime" disabled>
                      <!--ng-model="entity.launchTime" disabled-->
                      <!-- {{currentCom.createTime|date:'yyyy-MM-dd HH:mm:ss'}}-->

                    </div>
                    <div class="col-md-1 title rowHeight2x">Details</div>
                    <div class="col-md-11 data rowHeight2x">
                                            <textarea class="form-control" rows="3" ng-model="entity.body"
                                                      placeholder="..." required="required"></textarea>
                    </div>


                    <div class="col-md-1 title"></div>
                    <div class="col-md-11 data text-center">
                      <button type="button" class="btn btn-primary "
                              onclick='location.href="all-administrator-newstable.html"'
                              ng-click="save()">Save
                      </button>


                    </div>
                    <!--   <div><p ng-bind="entity.title"></p>
                           <p ng-bind="entity.time"></p>
                           <p ng-bind="nowtime"></p>
                           <p ng-bind="entity.body"></p>
                           <p>{{passednewsId}}</p>
                           <p>{{$scope.entity.title}}</p>
                           <p>{{$scope.entity.body}}</p>
                       </div>-->

                  </div>


                </div>

              </form>
              <!-- 数据表格 /-->


            </div>
            <div class="tab-pane" id="tab-picture">
              <div class="table-box">
                <div class="pull-left">
                  <div class="form-group form-inline">
                    <div class="btn-group">
                      <button type="button" class="btn btn-default" data-target="#NewModal"
                              data-toggle="modal"><i class="fa fa-file-o"></i> New
                      </button>

                    </div>
                  </div>
                </div>
                <table id="dataList" class="table table-bordered table-striped table-hover dataTable">
                  <thead>
                  <tr>

                    <th>Picture</th>

                    <th class="text-center">Operation</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr>

                    <td>
                      <img alt="" src="{{entity.picurl}}" width="100px" height="100px">
                    </td>
                    <td>
                      <button type="button" class="btn btn-default" ng-click="removeImage()"><i class="fa fa-trash-o"></i>
                        Delete
                      </button>
                    </td>
                  </tr>
                  </tbody>


                </table>


              </div>
            </div>
            <!-- /.box-body -->


          </div>
        </div>

      </div>

    </section>
    <!-- /.content -->


  </div>
  <!-- /.content-wrapper -->


  <!-- 底部导航 -->
  <footer class="main-footer">
    <div class="pull-right hidden-xs">
      <b>Version</b> 1.0.0
    </div>
    <strong>Copyright &copy; 2019 Team Nine </a>.</strong> All rights reserved.
  </footer>
  <!-- 底部导航 /-->

</div>

<div class="modal fade" id="NewModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">New Picture</h3>
      </div>
      <div class="modal-body">

        <table class="table table-bordered table-striped" width="800px">

          <tr>

            <td>

              Picture
            </td>
            <td>

              <input type="file" id="file" class="file"/>

            </td>


          </tr>
          <tr>
            <td>
              Show
            </td>
            <td><img src="{{entity.picurl}}" width="200px" height="200px">

              <button class="btn btn-primary" type="button" ng-click="uploadFile()">
                Upload
              </button>
            </td>

          </tr>
        </table>

      </div>
      <div class="modal-footer">
        <button class="btn btn-success" data-dismiss="modal" aria-hidden="true">Save</button>
        <button class="btn btn-default" data-dismiss="modal" aria-hidden="true" ng-click="resetFile()">Close</button>
      </div>
    </div>
  </div>
</div>
<script src="../plugins/jQuery/jquery-2.2.3.min.js"></script>
<script src="../plugins/jQueryUI/jquery-ui.min.js"></script>
<script>
  $.widget.bridge('uibutton', $.ui.button);
</script>
<script src="../plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="../plugins/raphael/raphael-min.js"></script>
<script src="../plugins/morris/morris.min.js"></script>
<script src="../plugins/sparkline/jquery.sparkline.min.js"></script>
<script src="../plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
<script src="../plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
<script src="../plugins/knob/jquery.knob.js"></script>


<script src="../plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
<script src="../plugins/slimScroll/jquery.slimscroll.min.js"></script>
<script src="../plugins/fastclick/fastclick.js"></script>
<script src="../plugins/iCheck/icheck.min.js"></script>
<script src="../plugins/adminLTE/js/app.min.js"></script>
<script src="../plugins/treeTable/jquery.treetable.js"></script>

<script src="../plugins/colorpicker/bootstrap-colorpicker.min.js"></script>
<script src="../plugins/bootstrap-wysihtml5/bootstrap-wysihtml5.zh-CN.js"></script>
<script src="../plugins/bootstrap-markdown/js/bootstrap-markdown.js"></script>
<script src="../plugins/bootstrap-markdown/locale/bootstrap-markdown.zh.js"></script>
<script src="../plugins/bootstrap-markdown/js/markdown.js"></script>
<script src="../plugins/bootstrap-markdown/js/to-markdown.js"></script>
<script src="../plugins/ckeditor/ckeditor.js"></script>
<script src="../plugins/input-mask/jquery.inputmask.js"></script>
<script src="../plugins/input-mask/jquery.inputmask.date.extensions.js"></script>
<script src="../plugins/input-mask/jquery.inputmask.extensions.js"></script>
<script src="../plugins/datatables/jquery.dataTables.min.js"></script>
<script src="../plugins/datatables/dataTables.bootstrap.min.js"></script>
<script src="../plugins/chartjs/Chart.min.js"></script>
<script src="../plugins/flot/jquery.flot.min.js"></script>
<script src="../plugins/flot/jquery.flot.resize.min.js"></script>
<script src="../plugins/flot/jquery.flot.pie.min.js"></script>
<script src="../plugins/flot/jquery.flot.categories.min.js"></script>
<script src="../plugins/ionslider/ion.rangeSlider.min.js"></script>
<script src="../plugins/bootstrap-slider/bootstrap-slider.js"></script>


<script type="text/javascript" src="../plugins/angularjs/angular.min.js"></script>
<link rel="stylesheet" href="../plugins/angularjs/pagination.css">
<script src="../plugins/angularjs/pagination.js"></script>

<script type="text/javascript">
  var app = angular.module('ihospital', []);

  app.service('loginService', function ($http) {

    this.loginName = function () {

      return $http.get('../login/name.do');

    }

  });

  app.service('uploadService', function ($http) {

    //上传文件
    this.uploadFile = function () {
      var formdata = new FormData();
      //file 文件上传框的name
      formdata.append('file', file.files[0]);
      return $http({
        url: '../upload2.do',
        method: 'post',
        data: formdata,
        headers: {'Content-Type': undefined},
        transformRequest: angular.identity

      });

    }

  });
  app.config(['$locationProvider', function ($locationProvider) {
    $locationProvider.html5Mode(true);
  }])
  app.controller('addnewsController', function ($scope, $http, $interval, $filter, $rootScope, $location, loginService, uploadService) {
      //获取登录名
      $scope.showLoginName = function () {
        loginService.loginName().success(
          function (response) {
            $scope.loginName = response.loginName;
          }
        )
      };

      $scope.passednewsId = null;
      if ($location.search().id) {
        $scope.passednewsId = $location.search().id;
      }
      $scope.findOne = function () {

        $scope.showLoginName();
        if ($scope.passednewsId != null) {
          $http.get('../news/findOne.do?id=' + $scope.passednewsId).success(
            function (response) {
              $scope.entity = response;
            }
          );
        }
      }

      $interval(function () {
        /*$scope.entity.time = $filter('date')(new Date(), "yyyy-MM-dd HH:mm:ss");*/
        $scope.entity.time = new Date()
        $scope.nowtime = $filter('date')($scope.entity.time, "yyyy-MM-dd HH:mm:ss");
      }, 1000);

      /*   $scope.reloadList = function () {
             //切换页码
             $scope.findPage($scope.paginationConf.currentPage, $scope.paginationConf.itemsPerPage);
         }
*/

      $scope.uploadFile = function () {
        uploadService.uploadFile().success(
          function (response) {
            if (response.success) {
              $scope.entity.picurl = response.message;
              var file = document.getElementById('file');
              file.outerHTML = file.outerHTML;
            } else {
              alert("Upload Failed!")
              var file = document.getElementById('file');
              file.outerHTML = file.outerHTML;
            }
          }
        );
      }
      $scope.resetFile = function () {
        $scope.entity.picurl = "";
        var file = document.getElementById('file');
        file.outerHTML = file.outerHTML;
      }
      $scope.removeImage = function () {
        $scope.entity.picurl = "";
      }

      $scope.save = function () {
        var methodName = 'addNews';//方法名称
        if ($scope.passednewsId != null) {//如果有ID
          methodName = 'updateNews';
          $scope.entity.newsId = $scope.passednewsId
          //则执行修改方法
        }
        if ($scope.entity.title != null && $scope.entity.body != null) {
          $http.post('../news/' + methodName + '.do', $scope.entity).success(
            function (response) {
              if (response.success) {
                //重新查询
                alert("Operation Successfully!");
                /*  $scope.reloadList();//重新加载*/
              } else {
                alert(response.message);
              }
            }
          );
        } else {
          alert("News's title and body can't be blank!")
        }
      }

    }
  )

</script>
<script>
  $("#file").fileinput();
  // 选择框
  $(document).ready(function () {

    $("#file").fileinput();
    // 选择框
    $(".select2").select2();

    // WYSIHTML5编辑器
    $(".textarea").wysihtml5({
      locale: 'zh-CN'
    });
  });


  // 设置激活菜单
  function setSidebarActive(tagUri) {
    var liObj = $("#" + tagUri);
    if (liObj.length > 0) {
      liObj.parent().parent().addClass("active");
      liObj.addClass("active");
    }
  }


  $(document).ready(function () {
    setSidebarActive("admin-blank");
  });
  $(document).ready(function () {

    //Date picker
    $('#datepicker').datepicker({
      autoclose: true,
      language: 'zh-CN'
    });


  });


</script>
</body>

</html>